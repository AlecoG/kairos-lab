---
import BaseLayout from "../layouts/BaseLayout.astro";
import SectionHeader from "../components/SectionHeader.astro";
import {
  badgeClass,
  brandLogoClass,
  btnGhostClass,
  btnPrimaryClass,
  containerClass,
  navLinkClass,
  navMenuClass,
  navToggleClass,
} from "../lib/ui";
const rawBase = import.meta.env.BASE_URL;
const base = rawBase.endsWith("/") ? rawBase : `${rawBase}/`;
---

<BaseLayout
  title="Catálogo | Kairos Lab"
  description="Catálogo completo de productos Kairos Lab: styling, barba, cuidado capilar y más."
  page="catalogo"
>
  <Fragment slot="head">
    <link
      rel="preload"
      as="image"
      href={`${base}assets/branding/logo-308.webp`}
      imagesrcset={`${base}assets/branding/logo-154.webp 154w, ${base}assets/branding/logo-308.webp 308w`}
      imagesizes="(max-width: 640px) 170px, 220px"
      fetchpriority="high"
    />
  </Fragment>

  <header class="sticky top-0 z-20 border-b border-[#e8e8e8] bg-white/85 backdrop-blur-[10px]" id="top">
    <div class={`${containerClass} flex items-center justify-between gap-4 py-3.5`}>
      <a class="flex shrink-0 items-center no-underline" href={base} aria-label="Ir al inicio">
        <picture class="block">
          <source
            type="image/webp"
            srcset={`${base}assets/branding/logo-154.webp 154w, ${base}assets/branding/logo-308.webp 308w`}
            sizes="(max-width: 640px) 170px, 220px"
          />
          <img
            class={brandLogoClass}
            src={`${base}assets/branding/logo.jpg`}
            alt="Kairos Lab"
            width="306"
            height="146"
            fetchpriority="high"
            decoding="async"
          />
        </picture>
      </a>

      <nav class="relative" aria-label="Navegación principal">
        <button
          class={navToggleClass}
          id="navToggle"
          aria-expanded="false"
          aria-controls="navMenu"
        >
          <span class="sr-only">Abrir menú</span>
          ☰
        </button>

        <div
          class={navMenuClass}
          id="navMenu"
          aria-hidden="true"
        >
          <a class={navLinkClass} href={base}>Inicio</a>
          <a class={navLinkClass} href={`${base}#servicios`}>Servicios</a>
          <a class={navLinkClass} href={`${base}#ubicacion`}>Ubicación</a>
          <a class={navLinkClass} href={`${base}#contacto`}>Contacto</a>
          <a class={btnPrimaryClass} id="btnCitaTop" href="#" target="_blank" rel="noopener">Agendar cita</a>
        </div>
      </nav>
    </div>
  </header>

  <main>
    <section
      class="border-b border-[#e8e8e8] py-11"
      style="background: radial-gradient(700px 360px at 14% 12%, rgba(0,0,0,.05), transparent 62%), radial-gradient(700px 360px at 86% 24%, rgba(0,0,0,.03), transparent 62%);"
    >
      <div class={containerClass}>
        <p class={badgeClass}>Catálogo completo</p>
        <h1 class="mb-2 mt-3 text-[clamp(2.2rem,4vw,3.2rem)]">Productos Kairos Lab</h1>
        <p class="m-0 max-w-4xl text-[1.05rem] leading-relaxed text-[#6b6b6b]">
          Explora todos los productos disponibles para barba, cuidado capilar y estilizado.
          Usa el buscador para encontrar rápido lo que necesitas.
        </p>
      </div>
    </section>

    <section class="border-y border-[#e8e8e8] bg-[#f6f6f6] py-12" id="productos">
      <div class={containerClass}>
        <SectionHeader title="Ver todos los productos" description="Estos son los productos más vendidos." />

        <div class="mb-4 flex flex-col items-stretch gap-4 sm:flex-row sm:items-center sm:justify-between">
          <div>
            <label class="block">
              <span class="sr-only">Buscar</span>
              <input
                class="w-full rounded-xl border border-[#e8e8e8] px-3.5 py-3 sm:w-[min(420px,70vw)]"
                id="productSearch"
                type="search"
                placeholder="Buscar por nombre, categoría o descripción…"
              />
            </label>
          </div>
          <div class="flex flex-wrap items-center gap-2.5">
            <button class={btnGhostClass} id="clearFilters">Limpiar</button>
            <a class={btnGhostClass} href={`${base}#productos`}>Volver a la home</a>
          </div>
        </div>

        <div
          class="mb-4 flex gap-2.5 overflow-x-auto pb-1 sm:flex-wrap sm:overflow-visible sm:pb-0"
          id="categoryFilters"
          role="group"
          aria-label="Filtrar por categoría"
        ></div>

        <aside class="mb-4 rounded-2xl border border-[#e8e8e8] bg-white p-4 shadow-[0_10px_30px_rgba(0,0,0,.08)]" id="catalogCart" aria-live="polite">
          <div class="mb-3 flex items-center justify-between gap-3">
            <h3 class="m-0">Carrito</h3>
            <span class="inline-flex items-center rounded-full border border-[#e8e8e8] px-2.5 py-1 text-sm font-bold text-[#6b6b6b]" id="cartCount">0 productos</span>
          </div>

          <div class="mb-4 grid gap-2.5" id="cartItems">
            <p class="text-[#6b6b6b]">Aún no agregas productos.</p>
          </div>

          <div class="flex flex-wrap gap-2.5 max-[640px]:grid max-[640px]:grid-cols-1">
            <button class={`${btnGhostClass} disabled:cursor-not-allowed disabled:opacity-50`} id="clearCart" type="button">Vaciar carrito</button>
            <button class={`${btnPrimaryClass} disabled:cursor-not-allowed disabled:opacity-50`} id="buyCart" type="button">Comprar por WhatsApp</button>
          </div>
        </aside>

        <div class="grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3" id="productsGrid"></div>
      </div>
    </section>

    <section class="py-12" id="contacto">
      <div class={`${containerClass} grid gap-5 md:grid-cols-1 lg:grid-cols-[1.2fr_.9fr_.9fr]`}>
        <div>
          <h2>Kairos Lab</h2>
          <p class="text-[#6b6b6b]">
            Barbería con estética minimalista: blanco y gris, enfoque premium y sin complicaciones.
          </p>
          <div class="mt-3 flex gap-3.5">
            <a class="font-extrabold text-[#6b6b6b] no-underline hover:text-[#111111]" href="#" aria-label="Instagram (actualiza el link)">Instagram</a>
            <a class="font-extrabold text-[#6b6b6b] no-underline hover:text-[#111111]" href="#" aria-label="TikTok (actualiza el link)">TikTok</a>
          </div>
        </div>

        <div>
          <h3>Contacto</h3>
          <ul class="m-0 grid list-none gap-2 p-0">
            <li><span class="text-[#6b6b6b]">WhatsApp:</span> <a id="waLinkFooter" href="#" target="_blank" rel="noopener">Enviar mensaje</a></li>
            <li><span class="text-[#6b6b6b]">Tel:</span> <a href="tel:+0000000000">+00 0000 0000</a></li>
            <li><span class="text-[#6b6b6b]">Email:</span> <a href="mailto:contacto@kairoslab.com">contacto@kairoslab.com</a></li>
            <li><span class="text-[#6b6b6b]">Dirección:</span> Calle 21 / 8 y 10, Vedado, Havana, Cuba</li>
          </ul>
        </div>

        <div>
          <h3>Horarios</h3>
          <ul class="m-0 grid list-none gap-2 p-0">
            <li><span class="text-[#6b6b6b]">Lunes a domingo:</span> 10:00–22:00</li>
          </ul>
        </div>
      </div>

      <div class={`${containerClass} flex items-center justify-between gap-4 border-t border-[#e8e8e8] py-4 pb-9 max-[640px]:flex-col max-[640px]:items-start`}>
        <p class="text-[#6b6b6b]">© <span id="year"></span> Kairos Lab. Todos los derechos reservados.</p>
        <a class="text-[#6b6b6b]" href="#top">Volver arriba ↑</a>
      </div>
    </section>
  </main>

  <a class="fixed bottom-4 right-4 z-30 rounded-full bg-[#111] px-4 py-3.5 font-black text-white no-underline shadow-[0_10px_30px_rgba(0,0,0,.08)] transition-all duration-200 opacity-0 invisible pointer-events-none translate-y-2.5" id="floatCta" href="#" target="_blank" rel="noopener" aria-label="Comprar por WhatsApp">
    WhatsApp · Comprar
  </a>
</BaseLayout>
